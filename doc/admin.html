<!DOCTYPE html>
<html>
    <head>
        <title>Administration</title>
        <link rel="stylesheet" type="text/css" href="../style.css">
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
    </head>

    <body>
        <div class="header">
            <img src="../logo.png" alt="Logo" width="150">
            <span class="header_text">The Small Issue Tracker - Documentation</span>
        </div>
        <div class="page">
<aside class='menu'>
<ul>
<li><a href='index.html'>Inroduction</a></li>
<li><a href='install.html'>Installation</a></li>
<li class='active'>Administration
<ul class=menu_level2>
<li><a href='#initiate-a-repository'>Initiate a Repository</a></li>
<li><a href='#create-a-project'>Create a Project</a></li>
<li><a href='#start-a-smit-web-server'>Start a smit web server</a></li>
<li><a href='#setup-a-smit-web-server-over-ssltls'>Setup a smit web server over SSL/TLS</a></li>
<li><a href='#command-line-usage'>Command Line Usage</a></li>
<li><a href='#project-configuration'>Project Configuration</a></li>
<li><a href='#set-up-a-trigger'>Set up a trigger</a></li>
<li><a href='#make-a-backup'>Make a Backup</a></li>
<li><a href='#faq'>FAQ</a></li>
</ul>
</li>
<li><a href='user_guide.html'>User Guide</a></li>
<li><a href='html.html'>Customize HTML</a></li>
<li><a href='api.html'>Smit API</a></li>
<li><a href='developers.html'>Developer Guide</a></li>
</ul>
</aside>
<div class='contents'>
<h1 id="administration">Administration</h1>
<p>The commands given in this chapter are to be issued in a shell in a Linux OS. They may need some adaptation on Windows.</p>
<h2 id="initiate-a-repository">Initiate a Repository</h2>
<pre><code>REPO=/path/to/some/dir
mkdir $REPO
smit init $REPO</code></pre>
<h2 id="create-a-project">Create a Project</h2>
<pre><code>cd $REPO
smit project -c &lt;project-name&gt;
smit user &lt;user-name&gt; --passwd &lt;pass&gt;
smit user &lt;user-name&gt; --project &lt;project-name&gt; admin</code></pre>
<h2 id="start-a-smit-web-server">Start a smit web server</h2>
<pre><code>smit serve</code></pre>
<h2 id="setup-a-smit-web-server-over-ssltls">Setup a smit web server over SSL/TLS</h2>
<p>Create a self-signed certificate:</p>
<pre><code>openssl genrsa &gt; privkey.pem
openssl req -new -x509 -key privkey.pem -out cacert.pub.pem -days 1095
cat privkey.pem cacert.pub.pem &gt; cacert.pem</code></pre>
<p>Start smit:</p>
<pre><code>smit serve --ssl-cert cacert.pem</code></pre>
<h2 id="command-line-usage">Command Line Usage</h2>
<pre><code>Usage: smit &lt;command&gt; [&lt;args&gt;]

The smit commands are:

  init        Initialise a smit repository
  project     List, create, or update a smit project
  user        List, create, or update a smit user
  serve       Start a smit web server
  version     Print the version
  help

See &#39;smit help &lt;command&gt;&#39; for more information on a specific command.</code></pre>
<h3 id="init">init</h3>
<pre><code>Usage: smit init [&lt;directory&gt;]

  Initialize a repository, where the smit projects are to be stored.

  If the directory exists, it must be empty.
  If the directory does not exist, it is created.
  If the directory is not given, . is used by default.</code></pre>
<h3 id="project">project</h3>
<pre><code>Usage: project [&lt;project-name&gt;] [options]

  List, create, or update a smit project.

Options:
  -c         Create a project, with a default structure. The structure
             may be modified online by an admin user.
  -d &lt;repo&gt;  select a repository by its path (by default . is used)</code></pre>
<h3 id="user">user</h3>
<pre><code>Usage: 1. smit user
       2. smit user &lt;name&gt; [options] [global-options]

  1. List all users and their configuration.
  2. With no option, print the configuration of a user.
     With options, create or update a user.

Options:
  --passwd &lt;pw&gt;     set the password
  --no-passwd       delete the password (leading to impossible login)
  --project &lt;project-name&gt; &lt;role&gt;
                    set a role (ref, ro, rw, admin) on a project
  --superadmin      set the superadmin priviledge (ability to create
                    projects and manage users via the web interface)
  --no-superadmin   remove the superadmin priviledge
  -d &lt;repo&gt;         select a repository by its path (by default . is used)

Roles:
    admin       able to modify an existing project
    rw          able to create and modify issues
    ro          able to read issues
    ref         may not access the project, but may be referenced</code></pre>
<h2 id="project-configuration">Project Configuration</h2>
<p>At the moment some configuration parameters are not driven by the web interface. Thus this paragraph explains how to set them.</p>
<p>The project configuration defines:</p>
<ul>
<li>the properties of the issues</li>
<li>the tags</li>
<li>the numbering scheme of the issues (local or global to several projects)</li>
</ul>
<p>The configuration may be modified in two ways:</p>
<ul>
<li>via the web interface
<ul>
<li>only the properties may be managed this way</li>
<li>hot reload</li>
</ul></li>
<li>via editing directly the configuration file, and performing a hot reload via the web interface</li>
</ul>
<p>The configuration of a project is given by the file <code>project</code> in the directory of the project.</p>
<h3 id="addproperty">addProperty</h3>
<pre><code>addProperty &lt;id&gt; [-label &lt;label&gt;] [-help &lt;help&gt;]Â &lt;type&gt; [values ...]</code></pre>
<p><code>addProperty</code> defines a property.</p>
<ul>
<li><code>&lt;id&gt;</code> is an identifier (only characters a-z, A-Z, 0-9, -, _)</li>
<li><code>&lt;label&gt;</code> is the text that will be displayed in the HTML pages (optional)</li>
<li><code>&lt;help&gt;</code> is a tooltip for properties inputs, displayed above properties labels (optional)</li>
<li><p><code>&lt;type&gt;</code> is one of text, select, multiselect, selectUser, textarea, textarea2</p>
<ul>
<li><code>text</code>: free text</li>
<li><code>select</code>: selection among a list if given values</li>
<li><code>multiselect</code>: same as select, but several may be selected at the same time</li>
<li><code>selectUser</code>: selection among the users of the project</li>
<li><code>textarea</code>: free text, multi-lines</li>
<li><code>textarea2</code>: same as textarea, but spanned on 2 columns in the HTML</li>
</ul></li>
<li><p><code>value</code> indicates the allowed values for types select and multiselect.</p></li>
</ul>
<h3 id="setpropertylabel">setPropertyLabel</h3>
<pre><code>setPropertyLabel &lt;propety-id&gt; &lt;label&gt;</code></pre>
<p><code>setPropertyLabel</code> defines the label for a property. This is used for mandatory properties that are not defined by <code>addProperty</code>: id, ctime, mtime, summary.</p>
<h3 id="numberissues">numberIssues</h3>
<p>(smit version &gt;= 1.4, no web interface)</p>
<pre><code>numberIssues global</code></pre>
<p><code>numberIssues</code> defines the numbering policy of the issues.</p>
<p>If not defined, the issues are numbered reletively to their project: 1, 2, 3,...</p>
<p>If <code>global</code> is set, then the numbering is shared by all the projects that have this policy.</p>
<h3 id="tag">tag</h3>
<p>(smit version &gt;= 1.3, no web interface)</p>
<p>Entries may be tagged.</p>
<pre><code>tag &lt;id&gt; -label &lt;text&gt; [-display]</code></pre>
<ul>
<li><code>&lt;id&gt;</code> may contain only letters, digits and underscores.</li>
<li><code>&lt;text&gt;</code> is the text to display in the HTML page</li>
<li><code>-display</code> requires the display of a box in the headers of issues, that indicates if at least one entry of the current issue is tagged (this may be seen as a checkbox, to quickly verify that some quality criterion is met).</li>
</ul>
<h3 id="full-example">Full example</h3>
<pre><code>setPropertyLabel id &quot;The ID&quot;

addProperty status -label &quot;The Status&quot; select open closed
addProperty owner -label &quot;The owner&quot; selectUser

numberIssues global

tag test -label &quot;Test Proof&quot; -display

trigger public/sendEmail.sh</code></pre>
<h2 id="set-up-a-trigger">Set up a trigger</h2>
<p>A trigger defines an external program to be launched after each new entry. It is typically useful for sending email notifications when some condition occur.</p>
<p>Triggers are not supported on Windows.</p>
<p>The file <code>trigger</code> in a smit project defines the path to the external program, on the first line.</p>
<p>Example:</p>
<pre><code>$ cat $REPO/project-X1/trigger
notifyNewEntry.py</code></pre>
<p>Notes:</p>
<ul>
<li>if the path is relative, it is considered relatively to the smit repository</li>
<li>the external program must be executable</li>
</ul>
<p>On creation or modification of an issue, the trigger will be called, and passed a JSON structure on its standard input, like this example:</p>
<pre><code>{
&quot;project&quot;:&quot;myproject&quot;,
&quot;issue&quot;:&quot;13&quot;,
&quot;entry&quot;:&quot;ed3eda2976914998cf2fcd759adf71753d0aa5f8&quot;,
&quot;author&quot;:&quot;fred&quot;,
&quot;users&quot;:{
  &quot;fred&quot;:&quot;admin&quot;,
  &quot;not assigned&quot;:&quot;ref&quot;,
  &quot;xxxt&quot;:&quot;rw&quot;},
&quot;modified&quot;:[&quot;a-b-c&quot;,&quot;multi-a&quot;,&quot;new-ttt&quot;,&quot;owner&quot;,&quot;test-reload&quot;,&quot;textarea2&quot;,&quot;xx&quot;],
&quot;properties&quot;:{
  &quot;a-b-c&quot;:[&quot;a-b-xx66&quot;,&quot;&quot;],
  &quot;multi-a&quot;:[&quot;%multi-h&quot;,&quot;42&quot;],
  &quot;new-ttt&quot;:[&quot;new-ttt&quot;,&quot;&quot;],
  &quot;owner&quot;:[&quot;owner&#39;44r%&quot;,&quot;fred&quot;],
  &quot;summary&quot;:[&quot;summary&quot;,&quot;fatal error x8&quot;],
  &quot;target_version&quot;:[&quot;target_version\&quot;22&quot;,&quot;v0.1&quot;],
  &quot;test-reload&quot;:[&quot;test-reloadx&quot;,&quot;&quot;],
  &quot;textarea2&quot;:[&quot;textarea2&quot;,&quot;&quot;],
  &quot;xx&quot;:[&quot;xx(yy)__99&quot;,&quot;&quot;]
},
&quot;message&quot;:&quot;...&quot;
}</code></pre>
<p>Example of trigger program is given: <a href="../downloads/notifyNewEntry.py">notifyNewEntry.py</a></p>
<h2 id="make-a-backup">Make a Backup</h2>
<p>Do a zip or tar of the repository, as follows:</p>
<pre><code>tar cvfz $REPO.tar.gz $REPO</code></pre>
<h2 id="faq">FAQ</h2>
<h3 id="why-cannot-i-create-a-project-named-public">Why cannot I create a project named 'public'?</h3>
<p><code>public</code> is reserved for storing HTML pages that are public, such as the signin page.</p>
<p>The reserve keywords that cannot be used as project names are:</p>
<pre><code>public
sm
users</code></pre>
<h3 id="how-do-i-delete-an-issue">How do I delete an issue?</h3>
<p>This can be achieved by an administrator as follows (but be careful, and make a backup first):</p>
<pre><code>rm -rf $REPO/&lt;project&gt;/issues/&lt;issue-id&gt;</code></pre>
<p>And hot-reload the project.</p>
</div>
        </div> <!-- div class page -->
        <div class="footer">
            Page updated on 21 Jul 2014
        </div>
    </body>
</html>
