<!DOCTYPE html>
<html>
    <head>
        <title>Developers' Guide</title>
        <link rel="stylesheet" type="text/css" href="../style.css">
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
    </head>

    <body>
        <div class="header">
            <img src="../logo.png" alt="Logo" width="150">
            <span class="header_text">The Small Issue Tracker - Documentation Smit v3.x</span>
        </div>
        <div class="page">
<aside class='menu'>
<ul>
<li><a href='index.html'>Introduction</a></li>
<li><a href='install.html'>Installation</a></li>
<li><a href='admin.html'>Administration</a></li>
<li><a href='experts.html'>Advanced Admin</a></li>
<li><a href='web_user_guide.html'>Web User Guide</a></li>
<li><a href='cloning.html'>Cloning</a></li>
<li><a href='html.html'>Customize HTML</a></li>
<li><a href='api.html'>Smit API</a></li>
<li class='active'>Developers' Guide
<ul class=menu_level2>
<li><a href='#software-architecture'>Software Architecture</a></li>
<li><a href='#directories-and-files'>Directories and files</a></li>
<li><a href='#objects'>Objects</a></li>
</ul>
</li>
</ul>
</aside>
<div class='contents'>
<h1 id="developers-guide">Developers' Guide</h1>
<h2 id="software-architecture">Software Architecture</h2>
<p>Smit:</p>
<ul>
<li>is built on top of <a href="http://code.google.com/p/mongoose/">Mongoose HTTP server</a></li>
<li>relies on OpenSSL for TLS authentication and encryption</li>
</ul>
<h2 id="directories-and-files">Directories and files</h2>
<p>The database is made of directories and files. The layout is as follows:</p>
<pre><code>$REPO
 &#9500;&#9472;&#9472; project-A
 &#9474;   &#9492;&#9472;&#9472; .smip
 &#9474;       &#9500;&#9472;&#9472; objects/
 &#9474;       &#9500;&#9472;&#9472; refs
 &#9474;       &#9474;   &#9500;&#9472;&#9472; issues/
 &#9474;       &#9474;   &#9500;&#9472;&#9472; project
 &#9474;       &#9474;   &#9500;&#9472;&#9472; tags/
 &#9474;       &#9474;   &#9500;&#9472;&#9472; trigger
 &#9474;       &#9474;   &#9492;&#9472;&#9472; views
 &#9474;       &#9492;&#9472;&#9472; templates/
 &#9500;&#9472;&#9472; project-B/
 &#9500;&#9472;&#9472; .../
 &#9500;&#9472;&#9472; public/
 &#9492;&#9472;&#9472; .smit
     &#9500;&#9472;&#9472; templates/
     &#9492;&#9472;&#9472; users
         &#9500;&#9472;&#9472; auth
         &#9492;&#9472;&#9472; permissions</code></pre>
<p>An issue is made up of successive immutable entries. The lastest entry is referenced by <code>.smip/refs/issues/&lt;id&gt;</code> (where <code>&lt;id&gt;</code> is the identifier of the issue).</p>
<h3 id="sample-entry-of-an-issue">Sample entry of an issue</h3>
<p>Entries are text files with straightforward key-value syntax.</p>
<pre><code>+parent null
+author Fred
+ctime 1379878590
+message &lt; -----------endofmsg---
&quot;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis
nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in
culpa qui officia deserunt mollit anim id est laborum.&quot;
-----------endofmsg---
+file a8fdc205a9f19cc1c7507a60c4f01b13d11d7fd0/a_file.txt
status open
target_version v1.0
summary &quot;Lorem ipsum dolor sit amet&quot;</code></pre>
<p>Keys with a <code>+</code> sign are specific to the entry and are not taken for the consolidation of the issue properties.</p>
<h3 id="file-project">File <code>project</code></h3>
<p>This file describes the structure of the properties of the project.</p>
<pre><code>setPropertyLabel id &quot;#&quot;
setPropertyLabel ctime Created
setPropertyLabel mtime Modified
setPropertyLabel summary Description
addProperty status -label &quot;The status&quot; select open closed deleted
addProperty target_version select v1.1 v1.2 v2.0 other
addProperty owner selectUser</code></pre>
<h3 id="file-usersauth">File <code>users/auth</code></h3>
<p>This file describes how the users authenticate.</p>
<pre><code>adduser &quot;John Smith&quot; -type sha1 -hash e61a3587b3f7a142b8c7b9263c82f8119398ecb7 \
    -salt b3f7a1
adduser alice -type krb5 -realm EXAMPLE.COM
adduser homer -type ldap -uri ldaps://example.com:389 \
    -dname &quot;cn=homer,ou=People,dc=example,dc=com&quot;</code></pre>
<h3 id="file-userspermissions">File <code>users/permissions</code></h3>
<p>This file describes the permissions of the users.</p>
<p>Example:</p>
<pre><code>setperm &quot;John Smith&quot; rw project-*
setperm &quot;John Smith&quot; superadmin
setperm &quot;John Smith&quot; ro project-B
setperm alice rw project-A</code></pre>
<h3 id="directory-public">Directory <code>public</code></h3>
<p>This directory contains public material, such as logo, <code>style.css</code>, and any contents that you wish to make available publicly.</p>
<h2 id="objects">Objects</h2>
<p><code>objects</code> is a database that stores:</p>
<ul>
<li>the entries</li>
<li>the attached files</li>
<li>the configuration of the project</li>
<li>the views</li>
</ul>
<p>The file name of an object is based on the SHA1 sum of its contents. Example :</p>
<pre><code>sha1sum a_file.txt
a8fdc205a9f19cc1c7507a60c4f01b13d11d7fd0 a_file.txt</code></pre>
<p>This file shall be stored at this location:</p>
<pre><code>.smip/objects/a8/fdc205a9f19cc1c7507a60c4f01b13d11d7fd0</code></pre>
<p>The original names of the files are not known in the <code>objects</code> database layout. The names of attached files are kept in the entries that reference the files (see the example of an entry, above).</p>
</div>
        </div> <!-- div class page -->
        <div class="footer">
            Page updated on 18 Sep 2015
        </div>
    </body>
</html>
